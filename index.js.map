{"version":3,"sources":["index.es6"],"names":[],"mappings":";;;;;;;;;;;;qBAAkB,OAAO;;;;wBACJ,WAAW;;;;yBACb,WAAW;;8BACD,mBAAmB;;;;qCACzB,4BAA4B;;;;qBAEpC,UAAS,OAAO,EAAE,MAAM,EAAC;AACtC,MAAI,IAAI,GAAG,iCAAiB,MAAM,CAAC,CAAC;AACpC,MAAI,MAAM,GAAG,SAAT,MAAM,CAAG,KAAK;WAAI,sBAAS,MAAM,CACjC,mBAAM,aAAa,CAAC,IAAI,EAAE,EAAC,KAAK,EAAL,KAAK,EAAE,IAAI,EAAE,OAAO,EAAC,CAAC,CACpD;GAAA,CAAC;;AAEF,MAAI,KAAK,GAAG,wCAAW,MAAM,CAAC,CAAC;;AAE/B,WAAS,OAAO,GAAW;sCAAP,MAAM;AAAN,YAAM;;;AACxB,QAAG;AACD,WAAK,GAAG,MAAM,mBAAC,MAAM,EAAE,KAAK,SAAK,MAAM,EAAC,CAAC;AACzC,YAAM,CAAC,KAAK,CAAC,CAAC;KACf,CAAC,OAAM,CAAC,EAAC;AACR,UAAG,iBAAiB,IAAI,CAAC,EAAC;AACxB,eAAO,CAAC,KAAK,CAAC,mCAAmC,EAAE,MAAM,CAAC,CAAC;OAC5D,MAAM,MAAM,CAAC,CAAC;KAChB;GACF;;AAED,WAAS,KAAK;;;;8BAAyB;UAAxB,IAAe;UAAE,MAAM;;2BAAvB,IAAe;;UAAd,IAAI;;UAAK,IAAI;;;;AAC3B,cAAO,OAAO,MAAM,CAAC,IAAI,CAAC;AACxB,aAAK,UAAU;AAAG,iBAAO,MAAM,CAAC,IAAI,OAAC,CAAZ,MAAM,GAAO,KAAK,4BAAK,IAAI,GAAC,CAAC;AAAA,AACtD,aAAK,QAAQ;6BAAe,IAAI,QAAE,MAAM,CAAC,IAAI,CAAC;;kBAHlC,IAAI,GAAK,IAAI;;AAGuB;OACjD;AACD,UAAG,WAAW,IAAI,OAAO,MAAM,CAAC,CAAC;4BAAgB,GAAG,4BAAK,IAAI,UAAG,MAAM;;gBALxD,IAAI,GAAK,IAAI;;OAK4C;KACxE;GAAA;;AAED,WAAS,MAAM,CAAC,MAAM,EAAE,KAAK,EAAE,IAAI,EAAU;uCAAL,IAAI;AAAJ,UAAI;;;AAC1C,QAAI,WAAW,GAAG,KAAK,EAAE,IAAI,SAAK,IAAI,GAAG,MAAM,CAAC,OAAO,IAAI,EAAE,CAAC,CAAC;AAC/D,QAAG,IAAI,KAAK,WAAW,IAAI,WAAW,IAAI,OAAO,WAAW,EAAE,OAAO,WAAW,CAAC;;AAEjF,QAAG,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;AACrC,UAAI,IAAI,GAAG,gBAAK,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AACxE,aAAO,KAAK,CAAC,KAAK,CAAC,IAAI,EAAE,MAAM,mBAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,SAAK,IAAI,EAAC,CAAC,CAAA;KACjF;;AAED,QAAG,QAAQ,IAAI,IAAI,EAAC;UACb,GAAG,GAAS,IAAI;UAAX,GAAG,GAAI,IAAI;;AACrB,aAAO,KAAK,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;KAC5B;;AAED,UAAM,iBAAiB,CAAC;GACzB;;AAED,QAAM,CAAC,KAAK,CAAC,CAAC;CACf","file":"index.js","sourcesContent":["import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport {List} from \"immutable\";\r\nimport module2component from \"./lib/toComponent\";\r\nimport buildModel from \"./lib/buildModel/index.es6\";\r\n\r\nexport default function(domNode, module){\r\n  let Root = module2component(module);\r\n  let render = model => ReactDOM.render(\r\n      React.createElement(Root, {model, send: receive})\r\n  );\r\n\r\n  let model = buildModel(module);\r\n\r\n  function receive(...params){\r\n    try{\r\n      model = update(module, model, ...params);\r\n      render(model);\r\n    } catch(e){\r\n      if(\"NoActionHandler\" == e){\r\n        console.error(\"Could not find handler for action\", params);\r\n      } else throw e;\r\n    }\r\n  }\r\n\r\n  function match([head, ...tail], target){\r\n    switch(typeof target[head]){\r\n      case \"function\" : return target[head](model, ...tail);\r\n      case \"object\": return match(tail, target[head]);\r\n    }\r\n    if(\"undefined\" != typeof target._) return match(['_', ...tail], target)\r\n  }\r\n\r\n  function update(module, model, head, ...tail){\r\n    let matchResult = match([head, ...tail], module.actions || {});\r\n    if(null !== matchResult && \"undefined\" != typeof matchResult) return matchResult;\r\n\r\n    if(module.adopt && module.adopt[head]) {\r\n      let path = List.isList(model.get(head)) ? [head, tail.shift()] : [head];\r\n      return model.setIn(path, update(module.adopt[head], model.getIn(path), ...tail))\r\n    }\r\n\r\n    if(\"change\" == head){\r\n      let [key, val] = tail;\r\n      return model.set(key, val);\r\n    }\r\n\r\n    throw \"NoActionHandler\";\r\n  }\r\n\r\n  render(model);\r\n}"]}