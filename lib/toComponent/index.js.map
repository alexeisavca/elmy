{"version":3,"sources":["index.es6"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import React from \"react\";\r\nimport {fromJS} from \"immutable\";\r\nimport mapObjValues from \"@alexeisavca/ftools/dstructs/mapObjValues\";\r\nimport mapObjTuples from \"@alexeisavca/ftools/dstructs/mapObjTuples\";\r\nimport capitalize from \"@alexeisavca/ftools/strings/capitalize\";\r\nimport isMappable from \"../isMappable\";\r\n\r\nlet module2component = ({model = fromJS({}), adopt = {}, view}) => class extends React.Component{\r\n  constructor(...props){\r\n    super(...props);\r\n    let mkValueAccessor = key =>\r\n        maybeVal => \"undefined\" == typeof maybeVal ?\r\n            this.props.model.get(key) :\r\n            this.props.send(\"change\", key,\r\n                \"function\" == typeof maybeVal ? maybeVal(this.props.model.get(key)) : maybeVal\r\n            );\r\n\r\n    let accessors = {};\r\n    model.keySeq().forEach(key => accessors[key] = mkValueAccessor(key));\r\n    Object.keys(adopt).forEach(key => accessors[key] = mkValueAccessor(key));\r\n\r\n    this.getAccessors = () => accessors;\r\n\r\n    let boundClasses = mapObjValues(adopt, module2component);\r\n\r\n    let bindChild = (...path) => maybeModel => isMappable(maybeModel || this.props.model.getIn(path)) ?\r\n        (maybeModel || this.props.model.getIn(path)).map((_, key) =>  React.createElement(boundClasses[path[0]], {\r\n          model: this.props.model.getIn([...path, key]),\r\n          send: this.props.send.bind(null, ...path, key)\r\n        })).toArray() :\r\n        React.createElement(boundClasses[path[0]], {\r\n          model: this.props.model.getIn(path),\r\n          send: this.props.send.bind(null, ...path)\r\n        });\r\n\r\n    let boundChildren = mapObjTuples(adopt, ([key, module]) => [capitalize(key), bindChild(key)]);\r\n\r\n    this.getBoundChildren = () => boundChildren;\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps){\r\n    return this.props.model != nextProps.model;\r\n  }\r\n\r\n  render(){\r\n    return view(this.getAccessors(), this.getBoundChildren(), this.props.send, this.props.model);\r\n  }\r\n};\r\n\r\nexport default module2component;"]}