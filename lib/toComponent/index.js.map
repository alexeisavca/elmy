{"version":3,"sources":["index.es6"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import React from \"react\";\r\nimport {fromJS, List} from \"immutable\";\r\nimport mapObjValues from \"@alexeisavca/ftools/dstructs/mapObjValues\";\r\nimport mapObjTuples from \"@alexeisavca/ftools/dstructs/mapObjTuples\";\r\nimport capitalize from \"@alexeisavca/ftools/strings/capitalize\";\r\n\r\nlet module2component = ({model = fromJS({}), adopt = {}, view}) => class extends React.Component{\r\n  constructor(...props){\r\n    super(...props);\r\n    let mkValueAccessor = key =>\r\n        maybeVal => \"undefined\" == typeof maybeVal ?\r\n            this.props.model.get(key) :\r\n            this.props.send(\"change\", key,\r\n                \"function\" == typeof maybeVal ? maybeVal(this.props.model.get(key)) : maybeVal\r\n            );\r\n\r\n    let accessors = {};\r\n    model.keySeq().forEach(key => accessors[key] = mkValueAccessor(key));\r\n    Object.keys(adopt).forEach(key => accessors[key] = mkValueAccessor(key));\r\n\r\n    this.getAccessors = () => accessors;\r\n\r\n    let boundClasses = mapObjValues(adopt, module2component);\r\n\r\n    let bindChild = (...path) => () => List.isList(this.props.model.getIn(path)) ?\r\n        this.props.model.getIn(path).map((_, index) => bindChild(...path, index)()) :\r\n        React.createElement(boundClasses[path[0]], {\r\n          model: this.props.model.getIn(path),\r\n          send: this.props.send.bind(null, ...path)\r\n        });\r\n\r\n    let boundChildren = mapObjTuples(adopt, ([key, module]) => [capitalize(key), bindChild(key)]);\r\n\r\n    this.getBoundChildren = () => boundChildren;\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps){\r\n    return this.props.model != nextProps.model;\r\n  }\r\n\r\n  render(){\r\n    return view(this.getAccessors(), this.getBoundChildren(), this.props.send, this.props.model);\r\n  }\r\n};\r\n\r\nexport default module2component;"]}